<div class="bill-container">
  <div class="card bill-card">
    <h2 class="card-title">Create New Bill</h2>

    <form #billForm="ngForm" (ngSubmit)="submitBill()" novalidate>
      <div class="form-section customer-details">
        <label for="customerName">Customer Name</label>
        <input
          id="customerName"
          name="customerName"
          [(ngModel)]="customerName"
          required
          placeholder="Enter customer name"
          #customerNameInput="ngModel"
        />
        <div class="error-message" *ngIf="customerNameInput.invalid && customerNameInput.touched">
          Customer name is required.
        </div>
      </div>

      <div class="form-section item-list">
        <h3 class="section-title">Items</h3>
        <div *ngFor="let item of selectedItems; let i = index" class="item-row">
          <div class="form-field">
            <label>Item</label>
            <select
              [(ngModel)]="item.itemName"
              name="itemName{{ i }}"
              required
              #itemNameInput="ngModel"
            >
              <option value="">-- Select Item --</option>
              <option *ngFor="let opt of allItems" [value]="opt.itemName">
                {{ opt.itemName }}
              </option>
            </select>
            <div class="error-message" *ngIf="itemNameInput.invalid && itemNameInput.touched">
              Item is required.
            </div>
          </div>

          <div class="form-field">
            <label>Quantity</label>
            <input
              type="number"
              min="1"
              [(ngModel)]="item.itemQuantity"
              name="quantity{{ i }}"
              required
              #quantityInput="ngModel"
            />
            <div class="error-message" *ngIf="quantityInput.invalid && quantityInput.touched">
              Quantity must be at least 1.
            </div>
          </div>

          <div class="form-field readonly">
            <label>Price</label>
            <input
              type="text"
              [value]="getPrice(item.itemName) | currency : 'INR'"
              readonly
            />
          </div>

          <div class="remove-btn-wrapper">
            <button type="button" (click)="removeItem(i)" class="btn remove-btn">
              <span class="icon">üóëÔ∏è</span>
            </button>
          </div>
        </div>

        <div class="actions">
          <button type="button" (click)="addItem()" class="btn add-item-btn">
            <span class="icon">‚ûï</span> Add Item
          </button>
        </div>

        <div class="item-list-empty" *ngIf="selectedItems.length === 0">
          No items added yet.
        </div>
      </div>

      <div class="summary-section">
        <div class="total-summary">
          <strong>Total Amount:</strong> {{ getTotal() | currency : "INR" }}
        </div>

        <div class="form-section">
          <label>Payment Method</label>
          <select [(ngModel)]="paymentMethod" name="paymentMethod">
            <option value="cash">Cash</option>
            <option value="online">Online</option>
          </select>
        </div>

        <div *ngIf="paymentMethod === 'online'" class="qr-code-section">
          <h4 class="qr-title">üì± Scan to Pay</h4>
          <img src="assets\qr.jpg" alt="QR Code" class="qr-code" />
          <button type="button" (click)="markAsPaid()" class="btn paid-btn">
            <span class="icon">‚úÖ</span> Payment Done
          </button>
        </div>
      </div>
      
      <button
        class="btn submit-btn"
        type="submit"
        [disabled]="
          billForm.invalid ||
          selectedItems.length === 0 ||
          (paymentMethod === 'online' && !paymentCompleted)
        "
      >
        Submit Bill
      </button>
    </form>
  </div>
</div>